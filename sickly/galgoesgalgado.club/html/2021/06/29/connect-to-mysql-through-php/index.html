<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>connect-to-mysql-through-php</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/heti.min.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body><div class="header"><a class="github-link" target="_blank" rel="noopener" href="https://notabug.org/micaldas"><img class="github-image" src="/images/Aquicon-Github-small.png"></a><a class="email-link" href="mailto:mclds@protonmail.com"><img class="email-image" src="/images/email-small.png"></a><a class="subscribe-link" href="/atom.xml"><img class="subscribe-image" src="/images/subscribe-small.png"></a></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">connect-to-mysql-through-php</p></h2><div class="post-date"><time datetime="2021-06-29T11:04:46.000Z">2021-06-29</time></div><div class="post-content"><p>It’s been a while since I wrote on this blog.<br>As per usual, I got distracted doing absolutely nothing and forgot, for months, about this page.<br>In the meantime I remade its UI using the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> platform; I got bored of<br>all the frontend work that entails maintaining a site built from scratch. It is a type of work that I don’t respond well too. It’s<br>minute, detail-oriented, patient, and rewards persistence. All things that are alien to me.<br>All in all, I’m happy with the result. The layout I chose answers my aesthetic needs better than I ever could. This was one case of leaving it to the pros.<br>But this isn’t the subject that has brought me here. I wanted to talk about connecting to a database in a web setting.<br>I just installed <a target="_blank" rel="noopener" href="https://nginx.org/en/">Nginx</a>, and was looking for some cool projects that I could do.<br>I remembered that I could replicate my cli apps in a web setting. So I decided to create a page where you insert a search word and the app comes back with<br>all the bookmarks that were detected for that word.<br>When I started to do research on this, and by “research”, I mean, trying different things to see if they work, I was amazed at the number of web tutorials that gave examples that wont compile. I don’t know if its because it’s old code, my inability to understand it, or for sheer ineptitude of the tutorials authors,, but the fact remains that there’s a lot of iffy information out there.<br>Because of this, and to speed up a possible come back at this issue on a later date, I want to document the example that, in fact, compiled.<br>And here it is.<br>As the page that calls the php is just html about forms, I’m going to skip it and talk only about the php script.  </p>
<ol>
<li>First we keep in a variable, the query value that was sent from the question page, Where ‘pwd’<br>is the ‘name’ value of the HTML tag of the ‘submit’ function.  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$question</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br></pre></td></tr></table></figure></li>
<li>Define your login information in variables. Note the ‘$pdo’ variable, that uses <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/book.pdo.php">php-pdo</a><br>encompasses all values and that is what is going to be used later. I’ll just quote PHP’s own documentation to explain this: <blockquote>
<p>Connections are established by creating instances of the PDO base class. It doesn’t matter which<br>driver you want to use; you always use the PDO class name. The constructor accepts parameters<br>for specifying the database source (known as the DSN) and optionally for the username and<br>password (if any).  </p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$where</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$user</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;pwd&quot;</span>;</span><br><span class="line"><span class="variable">$pdo</span> = <span class="keyword">new</span> PDO(<span class="string">&quot;mysql:host=<span class="subst">$where</span>;dbname=<span class="subst">$dbname</span>&quot;</span>, <span class="variable">$user</span>, <span class="variable">$password</span>);</span><br></pre></td></tr></table></figure></li>
<li>This I don’t have no idea what it does or what is doing here. I’ll leave it for magical thinking<br>reasons.  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure></li>
<li>We create a variable that’ll deal with the preparation of sending the SQL query.<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stmt</span> = <span class="variable">$pdo</span>-&gt;prepare(<span class="string">&quot;SELECT site, username, comment, passwd FROM pwd WHERE MATCH(site, username, \</span></span><br><span class="line"><span class="string">comment) AGAINST (&#x27;<span class="subst">$question</span>&#x27; IN NATURAL LANGUAGE MODE)&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>This executes the prepared statement.  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stmt</span>-&gt;execute();</span><br></pre></td></tr></table></figure></li>
<li>This returns an array with all the results.  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$users</span> = <span class="variable">$stmt</span>-&gt;fetchAll()</span><br></pre></td></tr></table></figure></li>
<li>Once again, I cede the stage to PHP’s documentation:<blockquote>
<p>The foreach construct provides an easy way to iterate over arrays. foreach works only on arrays and<br>objects, and will issue an error when you try to use it on a variable with a different data type<br>or an uninitialized variable.</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$users</span> <span class="keyword">as</span> <span class="variable">$user</span>) </span><br></pre></td></tr></table></figure></li>
<li>This final part is a bit of mash with html, as I had to insert tags to style the output. What is<br>relevant to know is that each line echo’s a entry of the mysql output.  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">title</span>&quot;&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;   <span class="title">SITE</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">site</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;  <span class="title">USER</span> -  &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">username</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;    <span class="title">COMMENT</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">comment</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;   <span class="title">PASSWORD</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">passwd</span>&quot;]; ?&gt;&lt;/<span class="title">p</span>&gt;&lt;/<span class="title">div</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>And now the whole code:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">            <span class="variable">$question</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">            <span class="variable">$where</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">            <span class="variable">$user</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">            <span class="variable">$password</span> = <span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line">            <span class="variable">$dbname</span> = <span class="string">&quot;pwd&quot;</span>;</span><br><span class="line">            <span class="variable">$pdo</span> = <span class="keyword">new</span> PDO(<span class="string">&quot;mysql:host=<span class="subst">$where</span>;dbname=<span class="subst">$dbname</span>&quot;</span>, <span class="variable">$user</span>, <span class="variable">$password</span>);    </span><br><span class="line"></span><br><span class="line">            <span class="variable">$a</span>=<span class="number">1</span>;</span><br><span class="line">            <span class="variable">$stmt</span> = <span class="variable">$pdo</span>-&gt;prepare(<span class="string">&quot;SELECT site, username, comment, passwd FROM pwd WHERE MATCH(site, username, comment) AGAINST (&#x27;<span class="subst">$question</span>&#x27; IN NATURAL LANGUAGE MODE)&quot;</span>);</span><br><span class="line">            <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">            <span class="variable">$users</span> = <span class="variable">$stmt</span>-&gt;fetchAll();</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$users</span> <span class="keyword">as</span> <span class="variable">$user</span>) </span><br><span class="line">        &#123;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;p&gt;&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">title</span>&quot;&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;   <span class="title">SITE</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">site</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;  <span class="title">USER</span> -  &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">username</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;    <span class="title">COMMENT</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">comment</span>&quot;]; ?&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;   <span class="title">PASSWORD</span> - &quot;; <span class="title">echo</span> $<span class="title">user</span>[&quot;<span class="title">passwd</span>&quot;]; ?&gt;&lt;/<span class="title">p</span>&gt;&lt;/<span class="title">div</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span> &#125; ?&gt;</span></span><br></pre></td></tr></table></figure>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a target="_blank" rel="noopener" href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>