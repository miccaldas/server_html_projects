<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>URL shortener</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/heti.min.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body><div class="header"><a class="github-link" target="_blank" rel="noopener" href="https://notabug.org/micaldas"><img class="github-image" src="/images/Aquicon-Github-small.png"></a><a class="email-link" href="mailto:mclds@protonmail.com"><img class="email-image" src="/images/email-small.png"></a><a class="subscribe-link" href="/atom.xml"><img class="subscribe-image" src="/images/subscribe-small.png"></a></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">URL shortener</p></h2><div class="post-date"><time datetime="2021-06-23T07:24:00.000Z">2021-06-23</time></div><div class="post-content"><p>If I think of the things I use on a daily basis, I believe that I created a python, homemade version of almost everything.<br>Things like notes, password manager, music player and assorted small things.<br>The one thing I lacked was a URL shortener that, if not a necessity, is something I find myself using frequently.<br>I was using <a target="_blank" rel="noopener" href="https://github.com/ngevan/twzer">twzer</a>, a cli URL shortener that works so well that I didn’t have any interest in creating alternatives. And now that I have created it, twzer still shines as the best option.<br>But this one is mine, I made it. So it’s this that I am going to use.<br>In the imports you’ll see a mention from <strong>future</strong>, that I imagine is a python2 library. That means that I probably don’t need it in this code, but I’m feeling too lazy to test if this is correct. Let the fossil code stay.<br><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/contextlib.html">Contextlib</a> is a library that provides utilities for the with statement.<br><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/urllib.parse.html#module-urllib.parse">Urllib.parse</a> is necessary to escape the URL, <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/urllib.request.html">Urllib.request</a>, is a library to open URLs.<br>Colr, is the usual pretiffier.  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> with_statement</span><br><span class="line"><span class="keyword">import</span> contextlib</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen</span><br><span class="line"><span class="keyword">from</span> colr <span class="keyword">import</span> color</span><br></pre></td></tr></table></figure>
<p>We define the function to shorten the URL:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_shorten</span>(<span class="params">url</span>):</span></span><br></pre></td></tr></table></figure>
<p>we append the escaped URL to the end of tinyurl’s api URL. Then we open the request_url using urlopen.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request_url = (<span class="string">&#x27;http://tinyurl.com/api-create.php?&#x27;</span> +</span><br><span class="line">                   urlencode(&#123;<span class="string">&#x27;url&#x27;</span>: url&#125;))</span><br><span class="line">    <span class="keyword">with</span> contextlib.closing(urlopen(request_url)) <span class="keyword">as</span> response:</span><br></pre></td></tr></table></figure>
<p>The urlopen function returns a stream of bytes rather than a string, so in order to print it and alter it, we have to convert it into utf-8.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> response.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Finally all that remains to be done is presentation:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="built_in">input</span>(color(<span class="string">&#x27;What is your url? &#x27;</span>, fore=<span class="string">&#x27;#f37735&#x27;</span>))</span><br><span class="line">url_short = make_shorten(url)</span><br><span class="line"><span class="built_in">print</span>(color(<span class="string">&#x27;+------------------------------+&#x27;</span>, fore=<span class="string">&#x27;#f7d0cb&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(color(<span class="string">&#x27;| &#x27;</span>, fore=<span class="string">&#x27;#f7d0cb&#x27;</span>) + color(url_short, fore=<span class="string">&#x27;#f37735&#x27;</span>) + color(<span class="string">&#x27; |&#x27;</span>, fore=<span class="string">&#x27;#f7d0cb&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(color(<span class="string">&#x27;+------------------------------+&#x27;</span>, fore=<span class="string">&#x27;#f7d0cb&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>And that’s it.</p>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a target="_blank" rel="noopener" href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>