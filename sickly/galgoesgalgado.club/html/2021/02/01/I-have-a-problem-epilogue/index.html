<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>I Have a Problem - Epilogue</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/heti.min.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body><div class="header"><a class="github-link" target="_blank" rel="noopener" href="https://notabug.org/micaldas"><img class="github-image" src="/images/Aquicon-Github-small.png"></a><a class="email-link" href="mailto:mclds@protonmail.com"><img class="email-image" src="/images/email-small.png"></a><a class="subscribe-link" href="/atom.xml"><img class="subscribe-image" src="/images/subscribe-small.png"></a></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">I Have a Problem - Epilogue</p></h2><div class="post-date"><time datetime="2021-02-01T01:54:20.000Z">2021-02-01</time></div><div class="post-content"><p>I might be a little hasty, but I would say that I got the automating of the SQLite database table sorted.<br>I tried it a bunch of times and everything seems to be in order. I would be euphoric if it wasn’t this sinking feeling that I might’ve overlooked something.<br>But I think that this is more the result of being so involved in solving this. This one took a toll on me.<br>I was greatly misinformed <em>vis a vis</em> the relaxing qualities of pursuing an hobby.<br>Maybe it’s just me that haven’t learned to relax yet. It’ll probably take another 48 years.<br>So, if you remember or read the last post, I had two major problems, creating variables dynamically and finding the correct string manipulations that create a passable SQL query.<br>In the end, I sidestepped the former and solved the latter.<br>I was very ill at ease regarding the creation of dynamic variables. Everything and everyone that I found online said how bad an idea it is. And if it’s<br>still not clear for me why this is worse than spitting on soup (a Portuguese saying to describe something that is morally wrong), but it was enough for me to spend some effort in finding a solution that wouldn’t go through that road. What I found is that I didn’t need to. Which corroborates the myriad of people that I found in<br>Stack Overflow and its ilk, saying that one of the reasons for not doing it, was that there is always better solutions. I think I found one.<br>Let me show you what I’ve done:  </p>
<ol>
<li>Here are my imports. I have <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/collections.html">collections</a> to create the ordered dict, <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/sqlite3.html">sqlite3</a> to make the calls to the database, <a target="_blank" rel="noopener" href="https://pypi.org/project/Colr/">colr</a> because is very cool library to colorize terminal output, <a target="_blank" rel="noopener" href="https://github.com/gruns/icecream">icecream</a> is just the sweetest thing and I love it, <a target="_blank" rel="noopener" href="https://docs.python.org/3/library/re.html">re</a> is there for reasons that will become clear ahead.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">from</span> colr <span class="keyword">import</span> color</span><br><span class="line"><span class="keyword">from</span> icecream <span class="keyword">import</span> ic</span><br><span class="line"><span class="keyword">import</span> re</span><br></pre></td></tr></table></figure></li>
<li>Asking for the names of the database and its table:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What name do you want for the database? &#x27;</span>, fore=<span class="string">&#x27;#585a47&#x27;</span>))</span><br><span class="line">table_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What name do you want for the table? &#x27;</span>, fore=<span class="string">&#x27;#585a47&#x27;</span>))</span><br></pre></td></tr></table></figure></li>
<li>Creating the database. Printing some strings just for peace of mind:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    conn = sqlite3.connect(db_name)</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    ic(<span class="string">&quot;Database created and Successfully Connected to SQLite&quot;</span>)</span><br><span class="line">    sqlite_select_Query = <span class="string">&quot;select sqlite_version();&quot;</span></span><br><span class="line">    cur.execute(sqlite_select_Query)</span><br><span class="line">    record = cur.fetchall()</span><br><span class="line">    ic(<span class="string">&quot;SQLite Database Version is: &quot;</span>, record)</span><br><span class="line">    conn.commit()</span><br><span class="line"><span class="keyword">except</span> sqlite3.Error <span class="keyword">as</span> e:</span><br><span class="line">    ic(<span class="string">&quot;Error while connecting to db&quot;</span>, e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">if</span>(conn):</span><br><span class="line">        conn.close()</span><br></pre></td></tr></table></figure></li>
<li>Here, just as a refresher, is the code that collects the information about table structure from the users:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = collections.OrderedDict()</span><br><span class="line">col_num = <span class="built_in">int</span>(<span class="built_in">input</span>(color(<span class="string">&#x27;How many columns will you need? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>)))</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(col_num):</span><br><span class="line">    col_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What is the name of your column? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>))</span><br><span class="line">    key = col_name</span><br><span class="line">    a.setdefault(key, [])</span><br><span class="line">    att_num = <span class="built_in">int</span>(<span class="built_in">input</span>(color(<span class="string">&#x27;How many attributes will you need? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>)))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(att_num):</span><br><span class="line">        att_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What is the name of your attribute? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>))</span><br><span class="line">        a[key].append(att_name)</span><br></pre></td></tr></table></figure></li>
<li>Creating an empty list,<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new = []</span><br></pre></td></tr></table></figure></li>
<li>Opening a loop through the list that houses the answers to the questions of the last code block.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br></pre></td></tr></table></figure></li>
<li>Separating the column name and its associates attributes into a specific list:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b = (i, a[i])</span><br></pre></td></tr></table></figure></li>
<li>Aggregating the information separated by columns and respective attributes into a list of lists:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="built_in">list</span>(b)</span><br></pre></td></tr></table></figure></li>
<li>Appending the columns name to a new list, as a string. The transformation to string is to have them prepared for the manipulations we’ll do briefly.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new.append(<span class="built_in">str</span>(c[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure></li>
<li>Isolating the attributes part of the list as string.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="built_in">str</span>(c[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></li>
<li>Replacing the comma between the attributes by a space.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e = d.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li>Aggregating the <em>commaless</em> attributes to the ‘new’ list.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new.append(e)</span><br></pre></td></tr></table></figure></li>
<li>Transforming the list where you kept the column names and their attributes, after manipulation, into a string. ‘Corda’ in Portuguese, can mean ‘string’.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">corda = <span class="built_in">str</span>(new)</span><br></pre></td></tr></table></figure></li>
<li>We now create a new string but without the ‘[]””‘}’ characters in it.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor1 = corda.translate(&#123;<span class="built_in">ord</span>(i): <span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;[]&quot;&quot;&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure></li>
<li>Another pass, to remove the apostrophes.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor2 = cor1.translate(&#123;<span class="built_in">ord</span>(i): <span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;&#x27;&quot;</span>&#125;)</span><br></pre></td></tr></table></figure></li>
<li>Now we have the old problem, explained in detail in the last post, of what to do with the commas in the output. First we isolate the character in a variable.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub = <span class="string">&#x27;,&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Then we look for matches of commas in our clean string<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matches = re.finditer(sub, cor2)</span><br></pre></td></tr></table></figure></li>
<li>We identify their indices, and keep them in a list.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">matches_positions = [match.start() <span class="keyword">for</span> match <span class="keyword">in</span> matches]</span><br><span class="line">oc = matches_positions</span><br></pre></td></tr></table></figure></li>
<li>We noticed the following regularity in the distribution of the commas at this point. The first occurrence is there to separate the column name from its attributes, and we want to erase that one, the other is there to separate the list of attributes from the next key. And that we want to keep. So it’s necessary to delete commas, skipping one value and starting from 0. Because strings are immutable it is necessary to create another string that will house the indices to be replaced.<br>For that, we use the following command:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oc1 = oc[<span class="number">0</span>::<span class="number">2</span>]</span><br></pre></td></tr></table></figure></li>
<li>We turn the string with the clean query into a list, so as to iterate through it.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor3 = <span class="built_in">list</span>(cor2)</span><br></pre></td></tr></table></figure></li>
<li>We open a iterator, setting as condition the indices on the list of the ones to replace.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> oc1:</span><br></pre></td></tr></table></figure></li>
<li>Replacing the indices on the list of the query, with spaces, on the indexes that were marked in oc1.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor3[idx] = <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>Since we turned a string into a list, it separated all characters into different items. It’s needed to join them back again.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cor4 = <span class="string">&#x27;&#x27;</span>.join(cor3)</span><br></pre></td></tr></table></figure></li>
<li>Finally we define the structure of the query. This is what is going to be sent.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query = <span class="string">&#x27;CREATE TABLE &#x27;</span> + table_name + <span class="string">&#x27;(&#x27;</span> + cor4 + <span class="string">&#x27;)&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>And, at last, we send it to the database::<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    conn = sqlite3.connect(db_name)</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    cur.execute(query)</span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> sqlite3.Error <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error while connecting to db&quot;</span>, e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">if</span>(conn):</span><br><span class="line">        conn.close()</span><br></pre></td></tr></table></figure>
This is what I’ve done. I believe that there’s still room for improvement. Many of these steps were separated so I could have a clearer understanding of what I was doing, as people who think as they go along tend to do.<br>But that will be work for another time.<br>One where I’ll be less scared of changing something and ruining it all.<br>I’ll leave you with the complete code:</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; This module creates a SQLite database and defines and uploads a new table for said database&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">from</span> colr <span class="keyword">import</span> color</span><br><span class="line"><span class="keyword">from</span> icecream <span class="keyword">import</span> ic</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">db_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What name do you want for the database? &#x27;</span>, fore=<span class="string">&#x27;#585a47&#x27;</span>))</span><br><span class="line">table_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What name do you want for the table? &#x27;</span>, fore=<span class="string">&#x27;#585a47&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    conn = sqlite3.connect(db_name)</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    ic(<span class="string">&quot;Database created and Successfully Connected to SQLite&quot;</span>)</span><br><span class="line">    sqlite_select_Query = <span class="string">&quot;select sqlite_version();&quot;</span></span><br><span class="line">    cur.execute(sqlite_select_Query)</span><br><span class="line">    record = cur.fetchall()</span><br><span class="line">    ic(<span class="string">&quot;SQLite Database Version is: &quot;</span>, record)</span><br><span class="line">    conn.commit()</span><br><span class="line"><span class="keyword">except</span> sqlite3.Error <span class="keyword">as</span> e:</span><br><span class="line">    ic(<span class="string">&quot;Error while connecting to db&quot;</span>, e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">if</span>(conn):</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">collect_data</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Here we ask the user the information needed to create a table, then we process the output until is fit to be a SQL query, and uploaded it to the db&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    a = collections.OrderedDict()</span><br><span class="line">    col_num = <span class="built_in">int</span>(<span class="built_in">input</span>(color(<span class="string">&#x27;How many columns will you need? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>)))</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(col_num):</span><br><span class="line">        col_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What is the name of your column? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>))</span><br><span class="line">        key = col_name</span><br><span class="line">        a.setdefault(key, [])</span><br><span class="line">        att_num = <span class="built_in">int</span>(<span class="built_in">input</span>(color(<span class="string">&#x27;How many attributes will you need? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>)))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(att_num):</span><br><span class="line">            att_name = <span class="built_in">input</span>(color(<span class="string">&#x27;What is the name of your attribute? &#x27;</span>, fore=<span class="string">&#x27;#ff6f69&#x27;</span>))</span><br><span class="line">            a[key].append(att_name)</span><br><span class="line"></span><br><span class="line">    new = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        b = (i, a[i])</span><br><span class="line">        <span class="built_in">print</span>(b)</span><br><span class="line">        c = <span class="built_in">list</span>(b)</span><br><span class="line">        <span class="built_in">print</span>(c)</span><br><span class="line">        new.append(<span class="built_in">str</span>(c[<span class="number">0</span>]))</span><br><span class="line">        <span class="built_in">print</span>(new)</span><br><span class="line">        d = <span class="built_in">str</span>(c[<span class="number">1</span>])</span><br><span class="line">        <span class="built_in">print</span>(d)</span><br><span class="line">        e = d.replace(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        new.append(e)</span><br><span class="line">    <span class="built_in">print</span>(new)</span><br><span class="line">    corda = <span class="built_in">str</span>(new)</span><br><span class="line">    cor1 = corda.translate(&#123;<span class="built_in">ord</span>(i): <span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;[]&quot;&quot;&#x27;</span>&#125;)</span><br><span class="line">    cor2 = cor1.translate(&#123;<span class="built_in">ord</span>(i): <span class="literal">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;&#x27;&quot;</span>&#125;)</span><br><span class="line">    sub = <span class="string">&#x27;,&#x27;</span></span><br><span class="line">    matches = re.finditer(sub, cor2)</span><br><span class="line">    matches_positions = [match.start() <span class="keyword">for</span> match <span class="keyword">in</span> matches]</span><br><span class="line">    oc = matches_positions</span><br><span class="line">    oc1 = oc[<span class="number">0</span>::<span class="number">2</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;oc1 = &#x27;</span>, oc1)</span><br><span class="line">    cor3 = <span class="built_in">list</span>(cor2)</span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> oc1:</span><br><span class="line">        cor3[idx] = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    cor4 = <span class="string">&#x27;&#x27;</span>.join(cor3)</span><br><span class="line">    query = <span class="string">&#x27;CREATE TABLE &#x27;</span> + table_name + <span class="string">&#x27;(&#x27;</span> + cor4 + <span class="string">&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        conn = sqlite3.connect(db_name)</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(query)</span><br><span class="line">        conn.commit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> sqlite3.Error <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error while connecting to db&quot;</span>, e)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span>(conn):</span><br><span class="line">            conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    collect_data()</span><br></pre></td></tr></table></figure>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a target="_blank" rel="noopener" href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>