<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>urwid_project</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/heti.min.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body><div class="header"><a class="github-link" target="_blank" rel="noopener" href="https://notabug.org/micaldas"><img class="github-image" src="/images/Aquicon-Github-small.png"></a><a class="email-link" href="mailto:mclds@protonmail.com"><img class="email-image" src="/images/email-small.png"></a><a class="subscribe-link" href="/atom.xml"><img class="subscribe-image" src="/images/subscribe-small.png"></a></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">urwid_project</p></h2><div class="post-date"><time datetime="2021-08-07T11:45:05.000Z">2021-08-07</time></div><div class="post-content"><p>For no reason in particular, I’ve been playing with a version of the bookmarks app done in <a target="_blank" rel="noopener" href="http://urwid.org/">Urwid</a>.<br>One of the first things that strikes you while using this library is that it is old. The examples have the fit and finish of a 80’s Visual Basic cassette and the library has the clunky, organic charm of a project that grew naturally for many years.<br>Urwid has tons of charm.<br>And, on top of the charm, there’s the fact that I still can’t grok how <a target="_blank" rel="noopener" href="https://github.com/prompt-toolkit/python-prompt-toolkit">Prompt Toolkit</a> actually works.<br>So, for now, Urwid is my go-to.<br>One thing that doesn’t work in urwid is, making several questions in the same function.<br>Because of this, to add a bookmark entry in Urwid, I created six files:</p>
<ul>
<li>One to insert the title,</li>
<li>another for the comment,</li>
<li>another for the link,</li>
<li>and three more for the tag entries. k1, k2, k3.</li>
</ul>
<p>The same happened when I adapted the update function to Urwid. I had to create a file for each of the data points, that are needed to make an update. One for the column, another for the id and another for the update.<br>Only now, after it’s done, comes to me that I could have pooled all the add and update functions in two modules. I just had to create different functions for each one, and I would have now much less files.<br>But, at the same time, I like the cleanliness of having them distributed by files. It’s easier to isolate and debug.<br>Besides Urwid I also imported <a target="_blank" rel="noopener" href="https://loguru.readthedocs.io/en/stable/index.html">Loguru</a>, a simple to setup and use logging app; that I intend to install in all my future projects.<br>sys is needed for Loguru.<br>Here is the example of one such file, ‘add_title.py’:  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urwid</span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br></pre></td></tr></table></figure>
<p>Here I define the parameters for Loguru. It has nothing to do with our current subject.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fmt = <span class="string">&quot;&#123;time&#125; - &#123;name&#125; - &#123;level&#125; - &#123;message&#125;&quot;</span></span><br><span class="line">logger.add(<span class="string">&quot;spam.log&quot;</span>, level=<span class="string">&quot;DEBUG&quot;</span>, <span class="built_in">format</span>=fmt)</span><br><span class="line">logger.add(sys.stderr, level=<span class="string">&quot;ERROR&quot;</span>, <span class="built_in">format</span>=fmt)</span><br></pre></td></tr></table></figure>
<p>First we create a function that defines the exit key as ‘Q’ or ‘q’.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit_on_q</span>(<span class="params">key</span>):</span></span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> (<span class="string">&quot;q&quot;</span>, <span class="string">&quot;Q&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span> urwid.ExitMainLoop()</span><br></pre></td></tr></table></figure>
<p>Next we call the QuestionBox class and, inside it, create a function that defines that Urwid will record all keyboard key-presses as input; with the exception of of ‘enter’.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuestionBox</span>(<span class="params">urwid.Filler</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;We&#x27;ll create a tui window in urwid to ask the question&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">keypress</span>(<span class="params">self, size, key</span>):</span></span><br><span class="line">        <span class="keyword">if</span> key != <span class="string">&quot;enter&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>(QuestionBox, self).keypress(size, key)</span><br><span class="line">        texto = <span class="string">u&quot;%s.\n\nPRESS Q TO EXIT.&quot;</span> % edit.edit_text</span><br><span class="line">        self.original_widget = urwid.Text(texto, align=<span class="string">&quot;center&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>We define a color palette for the window.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">palette = [</span><br><span class="line">    (<span class="string">&quot;banner&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;#ff6f69&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;streak&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;light red&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;#ff6f69&quot;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>We ask for the title name from the user.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">edit = urwid.Edit((<span class="string">&quot;banner&quot;</span>, <span class="string">u&quot;WHAT IS THE TITTLE?\n&quot;</span>), align=<span class="string">&quot;center&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Create the fill and loop objects:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fill = QuestionBox(edit)</span><br><span class="line">loop = urwid.MainLoop(fill, palette, unhandled_input=exit_on_q)</span><br></pre></td></tr></table></figure>
<p>Set the terminal color for 256.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loop.screen.set_terminal_properties(colors=<span class="number">256</span>)</span><br></pre></td></tr></table></figure>

<p>An <a target="_blank" rel="noopener" href="https://tinyurl.com/ye9kwop6">AttrMap</a> decoration is created to wrap the text widget with display attribute ‘streak’. AttrMap widgets allow you to map any display attribute to any other display attribute, but by default they will set the display attribute of everything that does not already have a display attribute. A second AttrMap widget is created to wrap the Filler widget with attribute ‘bg’.  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loop.widget = urwid.AttrMap(fill, <span class="string">&quot;bg&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>And, finally, we run the loop.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loop.run()</span><br></pre></td></tr></table></figure>
<p>Since I can’t send the information immediately to the database, as all the data points required are dispersed by three files, I chose to store it in a file, yes, more files, so I could send it later. And by later I mean, after having all the information needed.  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;title.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(edit.get_edit_text())</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>The full document:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;Adding a new note. Title question&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urwid</span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fmt = <span class="string">&quot;&#123;time&#125; - &#123;name&#125; - &#123;level&#125; - &#123;message&#125;&quot;</span></span><br><span class="line">logger.add(<span class="string">&quot;spam.log&quot;</span>, level=<span class="string">&quot;DEBUG&quot;</span>, <span class="built_in">format</span>=fmt)</span><br><span class="line">logger.add(sys.stderr, level=<span class="string">&quot;ERROR&quot;</span>, <span class="built_in">format</span>=fmt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit_on_q</span>(<span class="params">key</span>):</span></span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> (<span class="string">&quot;q&quot;</span>, <span class="string">&quot;Q&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span> urwid.ExitMainLoop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuestionBox</span>(<span class="params">urwid.Filler</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;We&#x27;ll create a tui window in urwid to ask the question&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">keypress</span>(<span class="params">self, size, key</span>):</span></span><br><span class="line">        <span class="keyword">if</span> key != <span class="string">&quot;enter&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>(QuestionBox, self).keypress(size, key)</span><br><span class="line">        texto = <span class="string">u&quot;%s.\n\nPRESS Q TO EXIT.&quot;</span> % edit.edit_text</span><br><span class="line">        self.original_widget = urwid.Text(texto, align=<span class="string">&quot;center&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">palette = [</span><br><span class="line">    (<span class="string">&quot;banner&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;#ff6f69&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;streak&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;light red&quot;</span>),</span><br><span class="line">    (<span class="string">&quot;bg&quot;</span>, <span class="string">&quot;white&quot;</span>, <span class="string">&quot;#ff6f69&quot;</span>),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">edit = urwid.Edit((<span class="string">&quot;banner&quot;</span>, <span class="string">u&quot;WHAT IS THE TITTLE?\n&quot;</span>), align=<span class="string">&quot;center&quot;</span>)</span><br><span class="line">fill = QuestionBox(edit)</span><br><span class="line">loop = urwid.MainLoop(fill, palette, unhandled_input=exit_on_q)</span><br><span class="line">loop.screen.set_terminal_properties(colors=<span class="number">256</span>)</span><br><span class="line">loop.widget = urwid.AttrMap(fill, <span class="string">&quot;bg&quot;</span>)</span><br><span class="line">loop.run()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;title.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(edit.get_edit_text())</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<hr>
<p>When I finally ended writing the app, and all the work was, apparently, done, I realized something that it could have been brought to my attention earlier. The Urwid documentation syntax, has a lot of content outside functions. This will be a big problem when importing all the files to the main file.<br>Add to this that, because I slavishly/mindlessly copied what I had seen in the documentation, I didn’t use any <code>if __name__ == &#39;__main__&#39;:</code> code in any file. This was shaping up to be an import nightmare.<br>I really didn’t wanted to refactor all  my code, so as to put it inside functions. If for nothing else, because Urwid wouldn’t probably work that way.<br>The solution I came up with was, create a python script where I execute all files, in Subprocess, as if they were running in the shell, ‘python &lt;file_name.py&gt;.<br>Let’s see an example. First we define the options on this main.py file. The ‘u’ in the beginning of the string defines its content as unicode. This is a definition that is not needed <a target="_blank" rel="noopener" href="https://docs.python.org/3/howto/unicode.html">since the birth of python3</a>, but this is how it’s written in Urwid’s documentation; and, because I only knew this after writing the app, it stays in the code until such time as I feel willing to refactor.   </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choices = <span class="string">u&quot;Add, See, Search, Delete, Update, Exit&quot;</span>.split()</span><br></pre></td></tr></table></figure>
<p>We define a vertical menu with this options.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params">title, choices</span>):</span></span><br><span class="line">    body = [urwid.Text(title), urwid.Divider()]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> choices:</span><br><span class="line">        button = urwid.Button(c)</span><br><span class="line">        urwid.connect_signal(button, <span class="string">&quot;click&quot;</span>, item_chosen, c)</span><br><span class="line">        body.append(urwid.AttrMap(button, <span class="literal">None</span>, focus_map=<span class="string">&quot;reversed&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> urwid.ListBox(urwid.SimpleFocusListWalker(body))</span><br></pre></td></tr></table></figure>
<p>Then we define the choice process.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">item_chosen</span>(<span class="params">button, choice</span>):</span></span><br><span class="line">    response = urwid.Text([<span class="string">u&quot;You chose &quot;</span>, choice, <span class="string">u&quot;\n&quot;</span>])</span><br><span class="line">    done = urwid.Button(<span class="string">u&quot;OK&quot;</span>)</span><br><span class="line">    urwid.connect_signal(done, <span class="string">&quot;click&quot;</span>, exit_program)</span><br><span class="line">    main.original_widget = urwid.Filler(urwid.Pile([response, urwid.AttrMap(done, <span class="literal">None</span>, focus_map=<span class="string">&quot;reversed&quot;</span>)]))</span><br><span class="line">    item_chosen.pick = <span class="built_in">str</span>(choice[:-<span class="number">1</span>])  <span class="comment"># Result comes with trailing comma. This gets rid of it.</span></span><br></pre></td></tr></table></figure>
<p>And the conditions for exiting the program.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit_program</span>(<span class="params">button</span>):</span></span><br><span class="line">    <span class="keyword">raise</span> urwid.ExitMainLoop()</span><br></pre></td></tr></table></figure>
<p>Here we define the visual look of the widget.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">main = urwid.Padding(menu(<span class="string">u&quot;Pythons&quot;</span>, choices), left=<span class="number">2</span>, right=<span class="number">2</span>)</span><br><span class="line">top = urwid.Overlay(</span><br><span class="line">    main,</span><br><span class="line">    urwid.SolidFill(<span class="string">u&quot;\N&#123;MEDIUM SHADE&#125;&quot;</span>),</span><br><span class="line">    align=<span class="string">&quot;center&quot;</span>,</span><br><span class="line">    width=(<span class="string">&quot;relative&quot;</span>, <span class="number">60</span>),</span><br><span class="line">    valign=<span class="string">&quot;middle&quot;</span>,</span><br><span class="line">    height=(<span class="string">&quot;relative&quot;</span>, <span class="number">60</span>),</span><br><span class="line">    min_width=<span class="number">20</span>,</span><br><span class="line">    min_height=<span class="number">9</span>,</span><br><span class="line">)</span><br><span class="line">urwid.MainLoop(top, palette=[(<span class="string">&quot;reversed&quot;</span>, <span class="string">&quot;standout&quot;</span>, <span class="string">&quot;&quot;</span>)]).run()</span><br></pre></td></tr></table></figure>
<p>And finally we arrive at the main function, where I use subprocess to start the files in python through the shell; thus circumventing the import problem.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Add&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_title.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_comment.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_link.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k1.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k2.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k3.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python connections.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;See&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python see.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Search&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python  search.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Delete&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python delete.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Update&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_column.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_id.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_update.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python updt_connections.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Exit&quot;</span>:</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>
<p>The full text:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python3.9</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;Main Module of the App. Where all the commands are accessed from&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> urwid</span><br><span class="line"><span class="keyword">from</span> loguru <span class="keyword">import</span> logger</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fmt = <span class="string">&quot;&#123;time&#125; - &#123;name&#125; - &#123;level&#125; - &#123;message&#125;&quot;</span></span><br><span class="line">logger.add(<span class="string">&quot;spam.log&quot;</span>, level=<span class="string">&quot;DEBUG&quot;</span>, <span class="built_in">format</span>=fmt)</span><br><span class="line">logger.add(sys.stderr, level=<span class="string">&quot;ERROR&quot;</span>, <span class="built_in">format</span>=fmt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">choices = <span class="string">u&quot;Add, See, Search, Delete, Update, Exit&quot;</span>.split()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span>(<span class="params">title, choices</span>):</span></span><br><span class="line">    body = [urwid.Text(title), urwid.Divider()]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> choices:</span><br><span class="line">        button = urwid.Button(c)</span><br><span class="line">        urwid.connect_signal(button, <span class="string">&quot;click&quot;</span>, item_chosen, c)</span><br><span class="line">        body.append(urwid.AttrMap(button, <span class="literal">None</span>, focus_map=<span class="string">&quot;reversed&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> urwid.ListBox(urwid.SimpleFocusListWalker(body))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">item_chosen</span>(<span class="params">button, choice</span>):</span></span><br><span class="line">    response = urwid.Text([<span class="string">u&quot;You chose &quot;</span>, choice, <span class="string">u&quot;\n&quot;</span>])</span><br><span class="line">    done = urwid.Button(<span class="string">u&quot;Ok&quot;</span>)</span><br><span class="line">    urwid.connect_signal(done, <span class="string">&quot;click&quot;</span>, exit_program)</span><br><span class="line">    main.original_widget = urwid.Filler(urwid.Pile([response, urwid.AttrMap(done, <span class="literal">None</span>, focus_map=<span class="string">&quot;reversed&quot;</span>)]))</span><br><span class="line">    item_chosen.pick = <span class="built_in">str</span>(choice[:-<span class="number">1</span>])  <span class="comment"># Result comes with trailing comma. This gets rid of it.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit_program</span>(<span class="params">button</span>):</span></span><br><span class="line">    <span class="keyword">raise</span> urwid.ExitMainLoop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main = urwid.Padding(menu(<span class="string">u&quot;Pythons&quot;</span>, choices), left=<span class="number">2</span>, right=<span class="number">2</span>)</span><br><span class="line">top = urwid.Overlay(</span><br><span class="line">    main,</span><br><span class="line">    urwid.SolidFill(<span class="string">u&quot;\N&#123;MEDIUM SHADE&#125;&quot;</span>),</span><br><span class="line">    align=<span class="string">&quot;center&quot;</span>,</span><br><span class="line">    width=(<span class="string">&quot;relative&quot;</span>, <span class="number">60</span>),</span><br><span class="line">    valign=<span class="string">&quot;middle&quot;</span>,</span><br><span class="line">    height=(<span class="string">&quot;relative&quot;</span>, <span class="number">60</span>),</span><br><span class="line">    min_width=<span class="number">20</span>,</span><br><span class="line">    min_height=<span class="number">9</span>,</span><br><span class="line">)</span><br><span class="line">urwid.MainLoop(top, palette=[(<span class="string">&quot;reversed&quot;</span>, <span class="string">&quot;standout&quot;</span>, <span class="string">&quot;&quot;</span>)]).run()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Add&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_title.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_comment.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_link.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k1.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k2.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python add_k3.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python connections.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;See&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python see.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Search&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python  search.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Delete&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python delete.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Update&quot;</span>:</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_column.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_id.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python update_update.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">        subprocess.run(<span class="string">&quot;python updt_connections.py&quot;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> item_chosen.pick == <span class="string">&quot;Exit&quot;</span>:</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a target="_blank" rel="noopener" href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>