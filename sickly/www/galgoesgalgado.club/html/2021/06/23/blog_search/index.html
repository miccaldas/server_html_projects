<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Blog Search</title><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/heti.min.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="" type="application/atom+xml">
</head><body><div class="header"><a class="github-link" target="_blank" rel="noopener" href="https://notabug.org/micaldas"><img class="github-image" src="/images/Aquicon-Github-small.png"></a><a class="email-link" href="mailto:mclds@protonmail.com"><img class="email-image" src="/images/email-small.png"></a><a class="subscribe-link" href="/atom.xml"><img class="subscribe-image" src="/images/subscribe-small.png"></a></div><div class="content"><div class="post-item"></div><h2 class="post-title-wrapper"><p class="post-title">Blog Search</p></h2><div class="post-date"><time datetime="2021-06-22T23:00:00.000Z">2021-06-23</time></div><div class="post-content"><p>Lately I’ve been mostly playing with this blog.<br>I’ve tried several designs, always a compromise between what I want to do and what I can do, to see if I can find a look that invites me to write.<br>In the absence of a clear and quantifiable goal for this blog, my measure of success has got to be something a little more diaphanous, in my case, a layout that makes me want to write in it.<br>That always been the difference between long-lived or ephemeral sites that I have had. If it is a design I like, I’ll write much more.<br>If you’re reading this, it’ll be obvious to you that I went with a minimalist theme. It was not my first or second choice, but it was clearly the one I felt happier with, given my precarious capacities as a web developer.<br>It is, and probably will be for a long time to come, a work in progress.<br>For instance, I still can’t design a CSS grid for the theme. I tried it, twice, and ended with monstrous atrocities that I had to kill at birth.<br>I haven’t given up yet. Just regrouping.<br>For now, the blog looks, approximately as I would like it to look, but the html and CSS behind it are a mess. And that is coming from me, who’s got no great knowledge of the subject and is easily satisfied.<br>My goal for this particular endeavour would be to have a solid scaffolding for the blog, based in one recognized CSS method. Could be grid, could be Flexbox. Something standard.<br>But clearly, this is something for a later date.<br>In what I had, surprisingly, much more success with, was with the backend features of the blog.<br>I created a MySQL database to house the metadata for the posts published here, and I was trying to find a way to use it as a search tool.<br>I had no idea of how I could do this, until I found the <a target="_blank" rel="noopener" href="https://www.w3schools.com/php/php_mysql_select.asp">W3</a> PHP tutorial, especially the part about mysql.<br>What got me right away was how intelligible PHP was. It just felt like something that would not be hard to pick up. So much so that, when looking at how it connects to a MySQL database, I was impressed by how similar to python code it was.<br>I was able, with the help of the tutorial, to create a page in the blog where you write your search query, and get a table with results from the db.<br>Although, in the interest of full disclosure, the table presentation was not my idea. It was in the tutorial, and I didn’t felt (feel), comfortable enough to make any changes.<br>Here’s what I ended up using:</p>
<ol>
<li>I used a post template of the blog to house the php code. Although I think that wouldn’t, in the end, matter very much.<br>That is why you’ll see here a header and ‘col.center’ div’s, as well as links to stylesheets that were never used.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height:500px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">col.center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;highlight&quot;</span> <span class="attr">style</span>=<span class="string">&quot;font-family:&#x27;Roboto Condensed, sans-serif&#x27;;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preconnect&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://fonts.gstatic.com&quot;</span>&gt;</span>                                                                                                                <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://fonts.googleapis.com/css2?family=Inconsolata&amp;family=JetBrains+Mono:ital,wght@1,500&amp;display=swap&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>Then, as always, I took a detour trying to style php code with CSS. For that mission I found this <a target="_blank" rel="noopener" href="https://css-tricks.com/css-variables-with-php/">article</a>, that purported to explain how to do just that. But I was just too dense to understand it. Anyway, here lies the link to CSS stylesheet, and the latter link; in case that anyone smarter than me can make heads or tails of it.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&#x27;text/css&#x27;</span> <span class="attr">href</span>=<span class="string">&#x27;style.php&#x27;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>I created a page with a search query, where I get the question and send it to another php page for processing. Now with the benefit of hindsight, it’s clear to me that I didn’t had to do it like this. So much so, that, in the end, I end up sending the output back to this page. But at the time I was just trying to make it work by following carefully the examples. But because it worked at first try I just couldn’t be bothered to refine it, and left it as is. At least for now.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/pages/action_page.php&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;quest&quot;</span>&gt;</span>SEARCH: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;quest&quot;</span> <span class="attr">name</span>=<span class="string">&quot;quest&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>In the other page, I open a php tag, get the result of the search query and keep it in a variable.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$question =  $_GET[&#x27;quest&#x27;];</span><br></pre></td></tr></table></figure></li>
<li>Below goes the styling for the table of results, as well as the format for its header. I fought tooth and nail to get these stylings to a CSS file, but I’m<br>totally out of my depth here, and couldn’t make it work. So I stuck with the tutorial example and added one or two personal touches.<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;<span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">&#x27;border: solid 5px black; border-collapse: collapse; border-radius: 35px; font-family:Roboto Condensed, sans-serif;&#x27;</span>&gt;</span>&quot;;</span><br><span class="line">  echo &quot;<span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>title<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>author<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>description<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>tags<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;<span class="name">th</span>&gt;</span>categories<span class="tag">&lt;/<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>&quot;;</span><br></pre></td></tr></table></figure></li>
<li>A class is opened where we’ll define an iterator, more table stylings and it’s structure. I wish I could be more in depth in this commentary, but the guide was scant in details and I haven’t done my due diligence yet.<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableRows</span> <span class="keyword">extends</span> <span class="title">RecursiveIteratorIterator</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$it</span></span>) </span>&#123;</span><br><span class="line">         <span class="built_in">parent</span>::__construct(<span class="variable">$it</span>, <span class="built_in">self</span>::LEAVES_ONLY);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">current</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;&lt;td style=&#x27;width:500px;border:5px solid black; text-align: center; padding: 15px; border-radius: 35px;&#x27;&gt;&quot;</span> .</span><br><span class="line"> <span class="built_in">parent</span>::current(). <span class="string">&quot;&lt;/td&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">beginChildren</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">endChildren</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;&lt;/tr&gt;&quot;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li>We then add the login information for the database,<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$where = &quot;localhost&quot;;</span><br><span class="line">$user = &quot;root&quot;;</span><br><span class="line">$password = &quot;xxxx&quot;;</span><br></pre></td></tr></table></figure></li>
<li>and connect to it. Again, this code is very similar to the one in Python.<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="variable">$conn</span> = <span class="keyword">new</span> PDO(<span class="string">&quot;mysql:host=<span class="subst">$where</span>;dbname=dazed&quot;</span>, <span class="variable">$user</span>, <span class="variable">$password</span>);</span><br><span class="line">	<span class="variable">$conn</span>-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);</span><br><span class="line">  <span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="string">&quot;SELECT title, author, description, tags, categories FROM dazed WHERE MATCH(title, author, description, tags, categories)</span></span><br><span class="line"><span class="string">                         AGAINST (&#x27;<span class="subst">$question</span>&#x27; IN NATURAL LANGUAGE MODE)&quot;</span>);</span><br><span class="line">  <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">  <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;setFetchMode(PDO::FETCH_ASSOC);</span><br><span class="line">  <span class="keyword">foreach</span>(<span class="keyword">new</span> TableRows(<span class="keyword">new</span> <span class="built_in">RecursiveArrayIterator</span>(<span class="variable">$stmt</span>-&gt;fetchAll())) <span class="keyword">as</span> <span class="variable">$k</span>=&gt;<span class="variable">$v</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$v</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">catch</span>(PDOException <span class="variable">$e</span>) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$conn</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">echo</span>  <span class="string">&quot;&lt;/table&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a target="_blank" rel="noopener" href="https://github.com/shinux/hexo-theme-adoubi">Adoubi</a> , Powered By Hexo.</div></div></body></html>